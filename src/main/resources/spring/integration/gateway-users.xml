<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:int="http://www.springframework.org/schema/integration"
	xmlns:int-ws="http://www.springframework.org/schema/integration/ws"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd
		http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-4.3.xsd
		http://www.springframework.org/schema/integration/ws http://www.springframework.org/schema/integration/ws/spring-integration-ws-4.3.xsd">

	<context:component-scan base-package="com.abelhzo.bus.soap.activator"/>
	<context:component-scan base-package="com.abelhzo.bus.soap.gateway" />
	<context:component-scan base-package="com.abelhzo.bus.soap.transformer" />

	<int:channel id="requestChannelDefault" />
	<int:channel id="responseChannelDefault" />

	<int:channel id="requestListRolChannel">
		<int:interceptors>
			<ref bean="interceptorLog"/>	
		</int:interceptors>
	</int:channel>
	<int:channel id="responseListRolChannel">
		<int:interceptors>
			<ref bean="interceptorLog"/>
		</int:interceptors>
	</int:channel>
	
	<int:channel id="requestGetRolChannel" />
	<int:channel id="responseGetRolChannel" />
	
	<int:chain input-channel="requestListRolChannel" output-channel="responseListRolChannel">
		<int-ws:outbound-gateway
			id="wsListRolGateway" 
			uri="http://localhost:8085/UsersManagementSOAP/RolesServiceSOAP" 
			marshaller="rolesMarshaller" unmarshaller="rolesMarshaller" />
			
		<int:transformer ref="rolesTransformer" method="responseListRol" />	
	</int:chain>
	
	<int:chain input-channel="requestGetRolChannel" output-channel="responseGetRolChannel">
		<int-ws:outbound-gateway
			id="wsGetRolGateway" 
			uri="http://localhost:8085/UsersManagementSOAP/RolesServiceSOAP" 
			marshaller="rolesMarshaller" unmarshaller="rolesMarshaller" />
			
		<int:transformer ref="rolesTransformer" method="responseGetRol" />	
	</int:chain>	
		
	<int:gateway
		id="rolesGateway"
		default-request-channel="requestChannelDefault"
		default-reply-channel="responseChannelDefault"
		service-interface="com.abelhzo.bus.soap.gateway.RolesGateway">
		
		<int:method name="getRolOP" request-channel="requestGetRolChannel" reply-channel="responseGetRolChannel" />		
		<int:method name="listRolOP" request-channel="requestListRolChannel" reply-channel="responseListRolChannel" />
	</int:gateway>	
		
	<bean id="rolesMarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
		<property name="packagesToScan">
			<list>
				<value>com.abelhzo.client.bus</value>
			</list>
		</property>
	</bean>
	
	<bean id="interceptorLog" class="com.abelhzo.bus.soap.interceptor.Interceptor" />

</beans>
